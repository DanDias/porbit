!function(e){function t(t){for(var i,r,n=t[0],o=t[1],c=t[2],d=0,p=[];d<n.length;d++)r=n[d],a[r]&&p.push(a[r][0]),a[r]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);for(l&&l(t);p.length;)p.shift()();return h.push.apply(h,c||[]),s()}function s(){for(var e,t=0;t<h.length;t++){for(var s=h[t],i=!0,n=1;n<s.length;n++){var o=s[n];0!==a[o]&&(i=!1)}i&&(h.splice(t--,1),e=r(r.s=s[0]))}return e}var i={},a={0:0},h=[];function r(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=i,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var n=window.webpackJsonp=window.webpackJsonp||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var l=o;h.push([2,1]),s()}([,function(e,t){t.Silver={name:"Silver",color:12632256,value:50},t.Gold={name:"Gold",color:13938487,value:100}},function(e,t,s){"use strict";s.r(t);var i=s(0),a=s.n(i);class h extends Phaser.GameObjects.Sprite{setText(e){this.label.text=e}constructor(e,t,s,i,a,h,r){super(e,t,s,"ui-button"),e.add.existing(this),this.setInteractive({useHandCursor:!0}),this.displayWidth=i,this.displayHeight=a,this.label=new Phaser.GameObjects.Text(e,t,s,h,r),this.label.setOrigin(.5),this.label.setDepth(10),this.setDepth(10),e.add.existing(this.label)}setSelected(e,t){void 0===t&&(t=43520),e?this.setTint(t):this.clearTint()}}class r extends Phaser.GameObjects.Text{constructor(e,t,s,i,a){super(e,t,s,i,a),e.tweens.add({targets:this,y:{value:s-150,duration:300,ease:"Linear",delay:1e3},alpha:{value:0,duration:300,ease:"EaseOut",delay:1e3},onComplete:this.finishTween})}finishTween(e,t){}}class n{constructor(e,t,s){this.fpsHighText=new Phaser.GameObjects.Text(e,t,s,"",{fill:"#0A0",fontSize:"10px"}),this.fpsActiveText=new Phaser.GameObjects.Text(e,t,s+10,"",{fill:"#AA0",fontSize:"10px"}),this.fpsLowText=new Phaser.GameObjects.Text(e,t,s+20,"",{fill:"#A00",fontSize:"10px"}),e.add.existing(this.fpsHighText),e.add.existing(this.fpsActiveText),e.add.existing(this.fpsLowText),this.fpsActiveText.low=999,this.fpsActiveText.high=0,this.game=e.game}update(e,t){var s=Math.round(this.game.loop.actualFps);this.fpsActiveText.text=s,this.fpsActiveText.high<s&&(this.fpsActiveText.high=this.fpsHighText.text=s),this.fpsActiveText.low>s&&(this.fpsActiveText.low=this.fpsLowText.text=s)}}class o{constructor(e,t,s,i){this.bar=new Phaser.GameObjects.Graphics(e),this.x=t,this.y=s,this.maxValue=this.value=i,this.aThird=.3*i,this.p=76/i,this.draw(),e.add.existing(this.bar)}destroy(){this.bar.destroy()}decrease(e){return this.value-=e,this.value<0&&(this.value=0),this.draw(),0===this.value}draw(){this.bar.clear(),this.bar.fillStyle(0),this.bar.fillRect(this.x,this.y,80,16),this.bar.fillStyle(16777215),this.bar.fillRect(this.x+2,this.y+2,76,12),this.value<this.aThird?this.bar.fillStyle(16711680):this.bar.fillStyle(65280);var e=Math.floor(this.p*this.value);this.bar.fillRect(this.x+2,this.y+2,e,12)}}var c=class extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i,a,h){super(e,t,s,a,h),e.add.existing(this),e.physics.add.existing(this),this.body.mass=i,this.setScale(1),this.durability=1,this.type="OrbitObject"}setScale(e){super.setScale(e),this.body.radius=.5*this.width*e}setVelocity(e,t){this.body.velocity.setTo(e,t)}onDestroyed(e){this.destroyed=e}onCollide(e){this.collision=e}doCollision(e){void 0!==this.collision&&this.collision(e)}takeDamage(e){this.durability-=e,void 0!==this.destroyed&&this.durability<=0&&this.destroyed(this)}},l=class extends c{constructor(e,t,s,i,a,h){super(e,t,s,i,a,h),this.type="Ship",this.detectionRadius=50,this.targetTypes=[],this.targets=[]}scanForTarget(e){var t=new a.a.Geom.Circle(this.x,this.y,this.detectionRadius);e.forEach(e=>{this.targetTypes.filter(t=>t==e.type).length>0&&a.a.Geom.Circle.ContainsPoint(t,new a.a.Geom.Point(e.x,e.y))&&0==this.targets.filter(t=>t===e).length&&(console.log(this.type+" acquired target "+e.type),e.on("destroy",()=>{this.targets=this.targets.filter(e=>{})}),this.targets.push(e))})}getClosestTarget(){var e=2*this.detectionRadius;return this.targets.filter(t=>{var s=a.a.Math.Distance.Between(t.x,t.y,this.x,this.y);return s<=e&&(e=s,!0)})[0]}getInterceptPoint(e,t){var s,i=new a.a.Math.Vector2(e.x,e.y),h=new a.a.Math.Vector2(e.body.velocity.x,e.body.velocity.y),r=new a.a.Math.Vector2(this.x,this.y),n=r.x-i.x,o=r.y-i.y,c=h.x*h.x+h.y*h.y-t*t,l=n*h.x+o*h.y;if(0==c)s=-(n*n+o*o)/(2*l);else{var d=-l/c,p=d*d-(n*n+o*o)/c;if(p<0)return;var y=Math.sqrt(p),g=d+y,m=d-y,u=Math.min(g,m),f=Math.max(g,m);if((s=u>0?u:f)<0)return}return s*=.5,new a.a.Math.Vector2(i.x+s*h.x,i.y+s*h.y)}},d=class extends l{constructor(e,t,s,i,a,h){super(e,t,s,1,i,a),this.scale=.15,this.setScale(this.scale),this.type="Collector",this.caught=[],this.collectCallback=h,this.targetTypes.push("Asteroid")}preUpdate(e,t){this.targets.forEach(e=>{e.body.setVelocity(0,0),e.setActive(!1),e.body.enable=!1;var s=new a.a.Math.Vector2(this.x-e.x,this.y-e.y);s.normalize(),s.scale(.1*this.body.velocity.length(),.1*this.body.velocity.length()),e.x+=s.x*t/60,e.y+=s.y*t/60;var i=new a.a.Geom.Circle(this.x,this.y,this.body.radius);a.a.Geom.Circle.ContainsPoint(i,e)&&(this.targets=this.targets.filter(t=>t!==e),void 0!==this.collectCallback&&this.collectCallback(e))})}},p=class extends l{constructor(e,t,s,i,a){super(e,t,s,1,i,a),this.scale=.15,this.setScale(this.scale),this.type="Shielder",this.empty=!1,this.rechargeTimer=0,this.particles=e.add.particles("flares"),this.emitter=this.particles.createEmitter({frame:{frames:["blue"],cycle:!0},quantity:4,frequency:50,scale:.15,lifespan:4e3,blendMode:"SCREEN"}),this.emitter.startFollow(this,-5,5,!0)}setTarget(e){this.target=e,this.target.addShielder(this),this.particles.createGravityWell({x:this.target.x,y:this.target.y,power:1,gravity:100});var t=new a.a.Geom.Circle(this.target.x,this.target.y,this.target.body.halfWidth);this.emitter.setDeathZone({type:"onEnter",source:t})}preUpdate(e,t){this.empty&&(this.rechargeTimer+=t,this.rechargeTimer>=2e3&&(this.empty=!1,this.rechargeTimer=0,this.durability=1,this.target.active&&(this.target.updateShield(!0),this.emitter.start()))),this.target.active?this.rotation=a.a.Math.Angle.BetweenPoints(this,this.target)+4*Math.PI:this.emitter.stop()}takeDamage(e){void 0!==this.destroyed&&this.durability<=0?(this.target.removeShielder(this),this.destroyed(this)):(this.durability-=e,0==this.durability&&(this.emitter.stop(),this.empty=!0))}},y=class extends a.a.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t,s,i,a),e.add.existing(this),e.physics.add.existing(this),this.scale=.1,this.setScale(this.scale),this.type="Bullet",this.life=5e3,this.body.mass=.25,this.body.radius=1,e.physics.world.bodies.entries.forEach(t=>{"EnemyRocket"==t.gameObject.type&&e.physics.add.overlap(this,t.gameObject,this.overlaps,null,this)})}overlaps(e,t){t.takeDamage(1),e.life=0,this.setActive(!1),this.setVisible(!1)}preUpdate(e,t){this.life-=t,this.life<=0&&(this.setActive(!1),this.setVisible(!1))}fire(e,t){this.setPosition(e,t),this.setActive(!0),this.setVisible(!0)}},g=class{constructor(e,t,s){this.parent=e,this.rechargeMax=t,this.recharge=t,this.speed=s,this.canFire=!1}update(e){0==this.canFire&&(this.recharge-=e,this.recharge<=0&&(this.recharge=this.rechargeMax,this.canFire=!0))}takeAShot(e){var t=new y(this.parent.scene,this.parent.x,this.parent.y,"bullet"),s=new a.a.Math.Vector2(e.x-this.parent.x,e.y-this.parent.y);s.normalize(),s.scale(this.speed),t.body.setVelocity(s.x,s.y),this.canFire=!1}},m=class extends l{constructor(e,t,s,i,a){super(e,t,s,1,i,a),this.scale=.25,this.setScale(this.scale),this.setTint(11141120),this.type="WeaponPlatform",this.detectionRadius=200,this.targetTypes.push("EnemyRocket"),this.gun=new g(this,500,200)}preUpdate(e,t){if(this.gun.update(t),this.gun.canFire&&this.targets.length>0){var s=this.getClosestTarget();if(void 0===s)return;var i=this.getInterceptPoint(s,this.gun.speed);if(void 0===i)return;this.gun.takeAShot(i)}}},u=class extends l{constructor(e,t,s,i,a){super(e,t,s,1,i,a),this.setTint(43520),this.scale=.25,this.setScale(this.scale),this.type="Interceptor",this.detectionRadius=300,this.speed=300,this.targetTypes.push("EnemyRocket"),this.gun=new g(this,100,100),this.mode="idle"}engage(e){this.originalVelocity=new a.a.Math.Vector2(this.body.velocity.x,this.body.velocity.y),this.originalPosition=new a.a.Math.Vector2(this.x,this.y),this.mode="engaging"}preUpdate(e,t){var s;switch(this.targets=this.targets.filter(e=>e.active),0==this.targets.length&&"idle"!=this.mode?this.mode="returning":s=this.targets[0],this.mode){case"idle":this.targets.length>0&&this.engage(this.targets[0]);break;case"engaging":var i=this.getInterceptPoint(s,this.speed);if(void 0!==i){var h=new a.a.Math.Vector2(i.x-this.x,i.y-this.y);h.normalize(),h.scale(this.speed*(t/60)),this.setVelocity(h.x,h.y)}if(this.gun.update(t),this.gun.canFire&&this.targets.length>0){var r=this.getClosestTarget();if(void 0===r)return;var n=new a.a.Math.Vector2(r.x+r.body.velocity.x,r.y+r.body.velocity.y);this.gun.takeAShot(n)}break;case"returning":var o;a.a.Math.Distance.Between(this.originalPosition.x,this.originalPosition.y,this.x,this.y)<=1?(o=this.originalVelocity,this.mode="idle"):((o=new a.a.Math.Vector2(this.originalPosition.x-this.x,this.originalPosition.y-this.y)).normalize(),o.scale(this.speed*(t/60))),this.setVelocity(o.x,o.y)}}},f=class{constructor(){this.Collector={name:"Collector",class:d,cost:10},this.Shielder={name:"Shielder",class:p,cost:50},this.WeaponPlatform={name:"WeaponPlatform",class:m,cost:100},this.Interceptor={name:"Interceptor",class:u,cost:500}}},b=class extends c{constructor(e,t,s,i,a,h){super(e,t,s,i,a,h),this.durability=10,this.scale=1,this.setScale(this.scale),this.type="Planet",this.hp=new o(e,t-.38*this.width,s-.9*this.height,this.durability),this.shielders=[],this.particles=e.add.particles("flares");var r=new Phaser.Geom.Circle(t,s,this.body.halfWidth);this.shields=this.particles.createEmitter({frame:{frames:["blue"],cycle:!0},frequency:1,scale:{start:.3,end:.05},blendMode:"ADD",emitZone:{type:"edge",source:r,quantity:60,yoyo:!1}}),this.shields.stop()}updateShield(){var e=this.shielders.filter(e=>!e.empty);0==e.length&&this.shields.on||!this.active?(this.shields.killAll(),this.shields.stop()):e.length>0&&!this.shields.on&&this.shields.start()}addShielder(e){this.shielders.push(e),this.updateShield()}removeShielder(e){this.shielders=this.shielders.filter(t=>t!==e),this.updateShield()}takeDamage(e){var t=this.shielders.filter(e=>!e.empty);t.length>0?t[0].takeDamage(e):(super.takeDamage(e),this.hp.decrease(e),this.durability<=0&&(this.hp.destroy(),this.updateShield())),this.updateShield()}},v=class extends l{constructor(e,t,s,i,a){super(e,t,s,1,i,a),this.scale=.25,this.setScale(this.scale),this.type="EnemyRocket"}setTarget(e){this.target=e}preUpdate(e,t){}},x=class extends c{constructor(e,t,s,i,a,h){super(e,t,s,.75,a,h),this.scale=.25,this.setScale(this.scale),this.mineralType=i,this.type="Asteroid",this.setTint(i.color)}preUpdate(e,t){}},w=s(1),S=s.n(w),T={type:a.a.AUTO,parent:"game",width:window.innerWidth,height:window.innerHeight,pixelArt:!0,physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[class extends a.a.Scene{constructor(){super({key:"InGame",active:!0}),this.spaceObjects=[],this.planet,this.planetMass=597200,this.flickScale=1,this.inaccuracy=1,this.flickEstimate={},this.simulationSteps=100,this.graphics,this.totalEnemies=30,this.cost=!0,this.spawning=!1,this.money=0,this.timer=0,this.referenceWidth=1024,this.referenceHeight=768}update(e,t){this.spaceObjects.forEach((e,t)=>{this.updateBody(e,t),void 0!==e.scanForTarget&&e.scanForTarget(this.spaceObjects)},this),this.uiScene.gameOver||(this.timer+=t,this.timer>500&&(this.money+=1,this.timer=0))}preload(){this.load.spritesheet("Collector","assets/collector.png",{frameWidth:200,frameHeight:200}),this.load.spritesheet("Shielder","assets/shielder.png",{frameWidth:200,frameHeight:200}),this.load.spritesheet("WeaponPlatform","assets/point.png",{frameWidth:29,frameHeight:29}),this.load.spritesheet("Interceptor","assets/point.png",{frameWidth:29,frameHeight:29}),this.load.spritesheet("asteroid","assets/point.png",{frameWidth:29,frameHeight:29}),this.load.spritesheet("bullet","assets/point.png",{frameWidth:29,frameHeight:29}),this.load.spritesheet("planet","assets/planet.png",{frameWidth:107,frameHeight:109}),this.load.spritesheet("boom","assets/explosion.png",{frameWidth:64,frameHeight:64,endFrame:23}),this.load.spritesheet("rocket","assets/rocket.png",{frameWidth:23,frameHeight:38}),this.load.atlas("flares","assets/flares.png","assets/flares.json")}create(){var e=this;this.uiScene=this.game.scene.getScene("InGameUI"),window.addEventListener("resize",function(t){e.resize(window.innerWidth,window.innerHeight)},!1);var t=this.game.config;this.graphics=this.add.graphics(),this.events.on("resize",e.resize,e),this.planet=new b(this,t.width/2,t.height/2,this.planetMass,"planet"),this.planet.onDestroyed(this.destroyObject),this.resize(window.innerWidth,window.innerHeight);var s={key:"explode",frames:this.anims.generateFrameNumbers("boom",{start:0,end:23,first:23}),frameRate:30,repeat:0};this.anims.create(s),this.flickEstimate=this.physics.add.sprite(0,0,""),this.flickEstimate.body.mass=1,this.flickEstimate.body.radius=32,this.flickEstimate.body.enable=!1,this.flickEstimate.visible=!1,this.input.on("pointerdown",function(e){if(1!=e.event.cancelBubble&&!this.uiScene.gameOver){var t=this.cameras.main.getWorldPoint(e.x,e.y);if(this.money<this.spawnMode.cost&&this.cost)return this.uiScene.showError("Need at least "+this.spawnMode.cost+" money",t),void(e.event.cancelBubble=!0);if(this.spawning=!0,"enemies"==this.spawnMode){var s=new v(this,t.x,t.y,"rocket");this.physics.accelerateToObject(s,this.planet,5),s.rotation=a.a.Math.Angle.BetweenPoints(s,this.planet)+Math.PI/2,s.onDestroyed(this.destroyObject),this.spaceObjects.push(s)}else{this.flickEstimate.body.velocity=a.a.Math.Vector2.ZERO;for(var i=this.simulateFrom(this.flickEstimate,t.x,t.y,this.simulationSteps),h=0;h<i.length-1;h++)this.drawLine(i[h].x,i[h].y,i[h+1].x,i[h+1].y,2,1044735)}}},this),this.input.on("pointerup",function(e){if(this.spawning&&"enemies"!=this.spawnMode&&!this.uiScene.gameOver){this.graphics.clear();var t=this.spawnMode.name,s=this.cameras.main.getWorldPoint(e.downX,e.downY),i=this.cameras.main.getWorldPoint(e.upX,e.upY),a=new this.spawnMode.class(this,s.x,s.y,t);"Shielder"!=this.spawnMode.name?"Collector"==this.spawnMode.name&&(a.collectCallback=(e=>{this.money+=e.mineralType.value,this.destroyObject(e,!1)})):a.setTarget(this.planet),a.onDestroyed(this.destroyObject),a.setVelocity((i.x-s.x)*this.flickScale,(i.y-s.y)*this.flickScale),this.spaceObjects.push(a),this.money-=this.spawnMode.cost,this.spawning=!1}},this),this.input.on("pointermove",function(e){if(e.isDown&&this.spawning&&"enemies"!=this.spawnMode&&!this.uiScene.gameOver){this.graphics.clear();var t=this.cameras.main.getWorldPoint(e.downX,e.downY),s=this.cameras.main.getWorldPoint(e.x,e.y);this.flickEstimate.body.velocity.setTo((s.x-t.x)*this.flickScale,(s.y-t.y)*this.flickScale);for(var i=this.simulateFrom(this.flickEstimate,t.x,t.y,this.simulationSteps),a=0;a<i.length-1;a++)this.drawLine(i[a].x,i[a].y,i[a+1].x,i[a+1].y,2,1044735)}},this),this.time.delayedCall(1e3*a.a.Math.RND.integerInRange(8,10),this.spawnAsteroid,[],this),this.time.delayedCall(1e3*a.a.Math.RND.integerInRange(3,8),this.spawnEnemy,[],this)}resize(e,t){this.cameras.main.setZoom(e/this.referenceWidth),this.cameras.main.setViewport(0,0,e,t);var s=.5*t,i=-.5*e+this.planet.x,a=-s+this.planet.y;this.cameras.main.setScroll(i,a),this.game.config.width=e,this.game.config.height=t}spawnAsteroid(){var e=new a.a.Math.Vector2,t=new a.a.Math.Vector2;this.planet.getCenter(t),t.x+=a.a.Math.RND.between(-200,200),t.y+=a.a.Math.RND.between(-200,200);var s=a.a.Math.RND.between(500,1500);a.a.Geom.Circle.GetPoint(new a.a.Geom.Circle(t.x,t.y,s),a.a.Math.RND.frac(),e);var i=a.a.Math.RND.between(50,250),h=t.subtract(e);h.normalize();var r=h.scale(i),n=Object.keys(S.a),o=new x(this,e.x,e.y,S.a[n[a.a.Math.RND.between(0,n.length-1)]],"asteroid");o.body.setVelocity(r.x,r.y),o.setScale(.25),o.onDestroyed(this.destroyObject),this.spaceObjects.push(o),this.time.delayedCall(1e3*a.a.Math.RND.integerInRange(8,10),this.spawnAsteroid,[],this)}spawnEnemy(){var e=new a.a.Math.Vector2,t=new a.a.Math.Vector2;this.planet.getCenter(t),t.x+=a.a.Math.RND.between(-64,64),t.y+=a.a.Math.RND.between(-64,64);var s=a.a.Math.RND.between(500,1500);a.a.Geom.Circle.GetPoint(new a.a.Geom.Circle(t.x,t.y,s),a.a.Math.RND.frac(),e);var i=a.a.Math.RND.between(10,50),h=t.subtract(e);h.normalize();var r=h.scale(i),n=new v(this,e.x,e.y,"rocket");n.rotation=a.a.Math.Angle.BetweenPoints(n,this.planet)+Math.PI/2,n.setTarget(t.x,t.y),n.body.setVelocity(r.x,r.y),n.setScale(.5),n.onDestroyed(this.destroyObject),this.spaceObjects.push(n),this.totalEnemies-=1,this.totalEnemies>0&&this.time.delayedCall(1e3*a.a.Math.RND.integerInRange(3,8),this.spawnEnemy,[],this)}destroyObject(e,t){void 0===t&&(t=!0);var s=void 0===this.spaceObjects?this.scene:this;t&&s.explosion(e.body.x,e.body.y),s.spaceObjects=s.spaceObjects.filter((t,s)=>e!=t),"Planet"==e.type?s.setGameOver(!1):"EnemyRocket"==e.type&&0==s.totalEnemies&&s.setGameOver(!0),e.destroy()}setGameOver(e){this.uiScene.gameOver||this.uiScene.setGameOver(e)}simulateFrom(e,t,s,i){void 0===i&&(i=1e3);var h=16.666599999999743/i,r=[];e.x=t,e.y=s,e.body.enable=!0;for(var n=0;n<i;n++){var o=this.simulateUpdate(e,h);if(e.x+=e.body.velocity.x*h,e.y+=e.body.velocity.y*h,r[n]=new a.a.Math.Vector2(e.x,e.y),!o)break}return e.body.enable=!1,r}accelerateToObject(e,t,s){var i=Math.atan2(t.y-e.y,t.x-e.x);return e.body.acceleration.setToPolar(i,s),i}simulateUpdate(e,t){void 0===t&&(t=.1),e.body.acceleration.setTo(0,0),this.spaceObjects.forEach(function(t){var s=t.body.acceleration.x,i=t.body.acceleration.y,a=t.x-t.x,h=t.y-t.y,r=a*a+h*h;if(!(r>e.body.radius*e.body.radius))return!1;this.accelerateToObject(t,e,e.body.mass/r),s+=t.body.acceleration.x,i+=t.body.acceleration.y,t.body.acceleration.setTo(s,i)});var s=e.body.acceleration.x,i=e.body.acceleration.y,a=e.x-this.planet.x,h=e.y-this.planet.y,r=a*a+h*h;return!this.planet.active||!(r<this.planet.body.radius*this.planet.body.radius)&&(this.accelerateToObject(e,this.planet,this.planet.body.mass/r),s+=e.body.acceleration.x,i+=e.body.acceleration.y,e.body.acceleration.setTo(s,i),this.computeVelocity(e.body,t),!0)}computeVelocity(e,t){var s=e.velocity.x,i=e.acceleration.x,h=e.drag.x,r=e.maxVelocity.x,n=e.velocity.y,o=e.acceleration.y,c=e.drag.y,l=e.maxVelocity.y,d=e.speed,p=e.allowDrag,y=e.useDamping;if(e.allowGravity){var g=this.game.config.physics.arcade.gravity.x?this.game.config.physics.arcade.gravity.x:0,m=this.game.config.physics.arcade.gravity.y?this.game.config.physics.arcade.gravity.y:0;s+=(g+e.gravity.x)*t,n+=(m+e.gravity.y)*t}i?s+=i*t:p&&h&&(y?(s*=h,FuzzyEqual(d,0,.001)&&(s=0)):(h*=t,FuzzyGreaterThan(s-h,0,.01)?s-=h:FuzzyLessThan(s+h,0,.01)?s+=h:s=0)),o?n+=o*t:p&&c&&(y?(n*=c,FuzzyEqual(d,0,.001)&&(n=0)):(c*=t,FuzzyGreaterThan(n-c,0,.01)?n-=c:FuzzyLessThan(n+c,0,.01)?n+=c:n=0)),s=a.a.Math.Clamp(s,-r,r),n=a.a.Math.Clamp(n,-l,l),e.velocity.set(s,n)}updateBody(e){if(void 0!==e.body){e.body.acceleration.setTo(0,0);var t=e.scene,s=[];if(this.spaceObjects.forEach(function(i){if(i!==e){var a=i.body.acceleration.x,h=i.body.acceleration.y,r=i.x-e.x,n=i.y-e.y,o=r*r+n*n;o>e.body.radius*e.body.radius?(t.physics.accelerateToObject(i,e,i.body.mass/o),a+=i.body.acceleration.x,h+=i.body.acceleration.y,i.body.acceleration.setTo(a,h)):i.active&&e.active&&s.push(i)}}),s.length>0){for(var i=0;i<s.length;i++)s[i].takeDamage(1);e.takeDamage(1)}else{var a=e.body.acceleration.x,h=e.body.acceleration.y,r=e.x-t.planet.x,n=e.y-t.planet.y,o=r*r+n*n;if(!t.planet.active)return;o<t.planet.body.radius*t.planet.body.radius?(e.takeDamage(1),t.planet.takeDamage(1)):(t.physics.accelerateToObject(e,t.planet,t.planet.body.mass/o),a+=e.body.acceleration.x,h+=e.body.acceleration.y,e.body.acceleration.setTo(a,h))}}}explosion(e,t){var s=this.add.sprite(e,t,"boom",23);s.setScale(.25),s.anims.play("explode"),s.on("animationcomplete",e=>{s.destroy()})}DEG2RAD(e){return e*(Math.PI/180)}drawLine(e,t,s,i,h,r,n){h=h||1,r=r||16711935,n=n||.5,this.graphics.lineStyle(h,r,n),this.graphics.strokeLineShape(new a.a.Geom.Line(e,t,s,i))}drawArrow(e,t,s,i,h,r,n){h=h||1,r=r||16711935,n=n||.5,this.graphics.lineStyle(h,r,n);var o,c=new a.a.Geom.Line(e,t,s,i);this.graphics.strokeLineShape(c),o=a.a.Geom.Line.GetMidPoint(c);var l=new a.a.Geom.Line(s,i,o.x,o.y);this.graphics.strokeLineShape(a.a.Geom.Line.RotateAroundXY(l,s,i,DEG2RAD(20))),this.graphics.strokeLineShape(a.a.Geom.Line.RotateAroundXY(l,s,i,DEG2RAD(-40)))}drawEllipse(e,t,s,i){t=t||2,s=s||16776960,i=i||.5,this.graphics.lineStyle(t,s,i),this.graphics.strokeEllipseShape(e)}drawCircle(e,t,s,i){t=t||2,s=s||16711680,i=i||.5,this.graphics.lineStyle(t,s,i),this.graphics.strokeCircleShape(e)}},class extends a.a.Scene{constructor(){super({key:"InGameUI",active:!0}),this.moneyText=null,this.spawner=new f,this.spawnButtons=[],this.gameOver=!1}preload(){this.load.spritesheet("ui-button","assets/ui/button.png",{frameWidth:80,frameHeight:40})}update(e,t){this.moneyText.text="Money: "+this.gameScene.money,this.fps.update(e,t)}showError(e,t){var s=new r(this,t.x,t.y+30,e,{fill:"#FFF"});this.add.existing(s)}setGameOver(e){this.gameOver=!0,this.spawnButtons.forEach(e=>{e.active=!1}),this.gameOverText=new a.a.GameObjects.Text(this,this.game.config.width/2-35,this.game.config.height/2,e?"You destroyed all the enemies!":"Game over, man. Game over.",{fill:"#F00",fontWeight:"bold"}),this.add.existing(this.gameOverText),this.gameOverButton=new h(this,this.game.config.width/2-80,this.game.config.height/2-25,160,50,"Restart",{fill:"#000"}),this.gameOverButton.on("pointerdown",function(e){window.location=window.location})}create(){var e=this.game.config;this.gameScene=this.game.scene.getScene("InGame"),this.moneyText=new a.a.GameObjects.Text(this,10,10,"Money: "+this.gameScene.money,{fill:"#FFF"}),this.fps=new n(this,this.game.config.width-25,10),this.add.existing(this.moneyText);var t=new h(this,this.game.config.width-85,this.game.config.height-25,160,50,(this.gameScene.cost?"":"Don't\n")+" Enforce Cost",{fill:"#000"}),s=this.gameScene;t.on("pointerdown",function(e){e.event.cancelBubble=!0,s.cost=!s.cost,this.setText((s.cost?"":"Don't\n")+" Enforce Cost")});var i=75,r=this;Object.keys(this.spawner).forEach(function(t){var s=this.spawner[t],a=new h(this,i,e.height-40,150,50,t+"\n$"+s.cost,{fill:"#000"});a.on("pointerdown",function(e){r.gameOver||(r.spawnButtons.forEach(e=>{e.setSelected(!1)}),e.event.cancelBubble=!0,r.gameScene.spawnMode=s,this.setSelected(!0))}),null===r.gameScene.spawnMode&&(r.gameScene.spawnMode=s,a.setSelected(!0)),i+=150,this.spawnButtons.push(a)},this)}}]};new a.a.Game(T),new f}]);
//# sourceMappingURL=bundle.js.map